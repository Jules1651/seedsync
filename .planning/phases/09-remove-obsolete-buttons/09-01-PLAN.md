---
phase: 09-remove-obsolete-buttons
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/angular/src/app/pages/files/file-options.component.html
  - src/angular/src/app/pages/files/file-options.component.ts
  - src/angular/src/app/pages/files/file-options.component.scss
  - src/angular/src/app/pages/files/file.component.html
  - src/angular/src/app/pages/files/file.component.scss
  - src/angular/src/app/services/files/view-file-options.ts
  - src/angular/src/app/services/files/view-file-options.service.ts
  - src/angular/src/app/common/storage-keys.ts
  - src/angular/src/app/tests/unittests/services/files/view-file-options.service.spec.ts
autonomous: true

must_haves:
  truths:
    - "Details button is not visible in the file options bar"
    - "Pin button is not visible in the file options bar"
    - "File list displays normally without details section"
    - "File options bar is no longer sticky (always static)"
    - "Application builds without errors"
    - "All unit tests pass"
  artifacts:
    - path: "src/angular/src/app/pages/files/file-options.component.html"
      provides: "File options template without Details/Pin buttons"
      must_not_contain: ["toggle-details", "pin-filter", "small-buttons", "class.sticky"]
    - path: "src/angular/src/app/pages/files/file-options.component.ts"
      provides: "File options component without toggle methods"
      must_not_contain: ["onToggleShowDetails", "onTogglePinFilter"]
    - path: "src/angular/src/app/services/files/view-file-options.ts"
      provides: "ViewFileOptions model without showDetails/pinFilter"
      must_not_contain: ["showDetails", "pinFilter"]
    - path: "src/angular/src/app/services/files/view-file-options.service.ts"
      provides: "Service without setShowDetails/setPinFilter methods"
      must_not_contain: ["setShowDetails", "setPinFilter", "VIEW_OPTION_SHOW_DETAILS", "VIEW_OPTION_PIN"]
    - path: "src/angular/src/app/common/storage-keys.ts"
      provides: "Storage keys without obsolete constants"
      must_not_contain: ["VIEW_OPTION_SHOW_DETAILS", "VIEW_OPTION_PIN"]
  key_links:
    - from: "file-options.component.html"
      to: "view-file-options.service.ts"
      via: "Template bindings removed"
      pattern: "showDetails|pinFilter references removed from template"
    - from: "view-file-options.service.ts"
      to: "view-file-options.ts"
      via: "Model property references removed"
      pattern: "No showDetails/pinFilter in constructor or methods"
---

<objective>
Remove the obsolete Details and Pin buttons from the file options bar.

Purpose: These buttons no longer serve a purpose after recent UI changes - Details is incompatible with fixed-height virtual scroll rows, and Pin is unnecessary since the actions bar is always visible.

Output: Clean file options bar with only functional controls (search, status filter, sort). All associated state, styles, and tests removed.
</objective>

<execution_context>
@/Users/julianamacbook/.claude/get-shit-done/workflows/execute-plan.md
@/Users/julianamacbook/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/09-remove-obsolete-buttons/09-RESEARCH.md

# Source files to modify
@src/angular/src/app/pages/files/file-options.component.html
@src/angular/src/app/pages/files/file-options.component.ts
@src/angular/src/app/pages/files/file-options.component.scss
@src/angular/src/app/pages/files/file.component.html
@src/angular/src/app/pages/files/file.component.scss
@src/angular/src/app/services/files/view-file-options.ts
@src/angular/src/app/services/files/view-file-options.service.ts
@src/angular/src/app/common/storage-keys.ts
@src/angular/src/app/tests/unittests/services/files/view-file-options.service.spec.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Remove Details button and showDetails state (CLEAN-01)</name>
  <files>
    src/angular/src/app/pages/files/file-options.component.html
    src/angular/src/app/pages/files/file-options.component.ts
    src/angular/src/app/pages/files/file-options.component.scss
    src/angular/src/app/pages/files/file.component.html
    src/angular/src/app/pages/files/file.component.scss
    src/angular/src/app/services/files/view-file-options.ts
    src/angular/src/app/services/files/view-file-options.service.ts
    src/angular/src/app/common/storage-keys.ts
    src/angular/src/app/tests/unittests/services/files/view-file-options.service.spec.ts
  </files>
  <action>
Remove the Details button and all associated code following bottom-up removal order:

1. **file-options.component.html** (lines 159-178):
   - Delete the entire `<button id="toggle-details">` element and its contents

2. **file-options.component.ts** (lines 114-116):
   - Delete the `onToggleShowDetails()` method

3. **file.component.html** (lines 39-56):
   - Delete the entire `.details` div with `*ngIf="options?.showDetails"` and all nested content

4. **view-file-options.service.ts**:
   - Delete the `setShowDetails()` method (lines 51-59)
   - Delete the `showDetails` initialization in constructor (lines 26-27: `const showDetails: boolean = ...`)
   - Remove `showDetails: showDetails,` from the `new ViewFileOptions({...})` call (line 38)

5. **view-file-options.ts**:
   - Delete `showDetails: boolean;` from the `IViewFileOptions` interface (lines 10-11)
   - Delete `showDetails: null,` from `DefaultViewFileOptions` (line 29)
   - Delete `showDetails: boolean;` from the `ViewFileOptions` class (line 42)

6. **storage-keys.ts** (line 2):
   - Delete `public static readonly VIEW_OPTION_SHOW_DETAILS = "view-option-show-details";`

7. **file-options.component.scss**:
   - Delete the entire `#toggle-details` rule block (lines 156-188)
   - Update the margin rules (lines 210-221) to remove `#toggle-details` from selectors:
     - Line 213: Change `#toggle-details {` selector list to remove it
     - Line 219: Change `#toggle-details {` selector list to remove it
   - Update media query margin rules (lines 237-241) to remove `#toggle-details`

8. **file.component.scss** (lines 117-121):
   - Delete the `.details { display: none; }` rule inside `.text`

9. **view-file-options.service.spec.ts**:
   - Delete `expect(options.showDetails).toBe(false);` from default options test (line 47)
   - Delete the entire "should forward updates to showDetails" test (lines 60-87)
   - Delete the entire "should load showDetails from storage" test (lines 89-110)
   - Delete the entire "should save showDetails to storage" test (lines 112-124)
   - Update "should load sortMethod from storage" test (line 163) to remove the `expect(storageService.get).toHaveBeenCalledWith(StorageKeys.VIEW_OPTION_SHOW_DETAILS);` assertion

Verify build compiles after each file group change.
  </action>
  <verify>
Run `cd src/angular && npm run build` - should complete without errors.
Run `grep -r "showDetails" src/angular/src/app/` - should return no matches in .ts, .html, .scss files.
Run `grep -r "toggle-details" src/angular/src/app/` - should return no matches.
  </verify>
  <done>
Details button removed from UI, showDetails property removed from ViewFileOptions model, setShowDetails method removed from service, VIEW_OPTION_SHOW_DETAILS storage key removed, all related styles and tests removed. Build succeeds.
  </done>
</task>

<task type="auto">
  <name>Task 2: Remove Pin button and pinFilter state (CLEAN-02)</name>
  <files>
    src/angular/src/app/pages/files/file-options.component.html
    src/angular/src/app/pages/files/file-options.component.ts
    src/angular/src/app/pages/files/file-options.component.scss
    src/angular/src/app/services/files/view-file-options.ts
    src/angular/src/app/services/files/view-file-options.service.ts
    src/angular/src/app/common/storage-keys.ts
    src/angular/src/app/tests/unittests/services/files/view-file-options.service.spec.ts
  </files>
  <action>
Remove the Pin button and all associated code following bottom-up removal order:

1. **file-options.component.html**:
   - Delete the `[class.sticky]="(options | async)?.pinFilter"` binding from the `#file-options` div (line 3)
   - Delete the entire `<div id="small-buttons">` container and its contents including the pin button (lines 180-188)

2. **file-options.component.ts** (lines 118-120):
   - Delete the `onTogglePinFilter()` method

3. **view-file-options.service.ts**:
   - Delete the `setPinFilter()` method (lines 90-98)
   - Delete the `pinFilter` initialization in constructor (lines 31-32: `const pinFilter: boolean = ...`)
   - Remove `pinFilter: pinFilter,` from the `new ViewFileOptions({...})` call (line 42)

4. **view-file-options.ts**:
   - Delete `pinFilter: boolean;` from the `IViewFileOptions` interface (lines 22-23)
   - Delete `pinFilter: null,` from `DefaultViewFileOptions` (line 33)
   - Delete `pinFilter: boolean;` from the `ViewFileOptions` class (line 46)

5. **storage-keys.ts** (line 4):
   - Delete `public static readonly VIEW_OPTION_PIN = "view-option-pin";`

6. **file-options.component.scss**:
   - Delete the `.sticky` rule block (lines 13-18)
   - Delete the entire `#small-buttons` rule block including nested `#pin-filter` (lines 190-208)

7. **view-file-options.service.spec.ts**:
   - Delete `expect(options.pinFilter).toBe(false);` from default options test (line 51)
   - Delete the entire "should forward updates to pinFilter" test (lines 262-289)
   - Delete the entire "should load pinFilter from storage" test (lines 291-312)
   - Delete the entire "should save pinFilter to storage" test (lines 314-326)

After all removals, the `#file-options` div should have only `[style.top.px]` binding remaining (no class binding).
  </action>
  <verify>
Run `cd src/angular && npm run build` - should complete without errors.
Run `cd src/angular && npm test -- --browsers=ChromeHeadless --watch=false` - all tests should pass.
Run `grep -r "pinFilter" src/angular/src/app/` - should return no matches.
Run `grep -r "pin-filter" src/angular/src/app/` - should return no matches.
Run `grep -r "VIEW_OPTION_PIN" src/angular/src/app/` - should return no matches.
  </verify>
  <done>
Pin button removed from UI, pinFilter property removed from ViewFileOptions model, setPinFilter method removed from service, VIEW_OPTION_PIN storage key removed, sticky class and related styles removed, all related tests removed. Build and all tests pass.
  </done>
</task>

</tasks>

<verification>
After both tasks complete:

1. **Build verification:**
   ```bash
   cd src/angular && npm run build
   ```
   Expected: Build completes without errors or warnings related to removed code.

2. **Test verification:**
   ```bash
   cd src/angular && npm test -- --browsers=ChromeHeadless --watch=false
   ```
   Expected: All remaining tests pass.

3. **Code cleanup verification:**
   ```bash
   grep -r "showDetails\|pinFilter\|toggle-details\|pin-filter\|VIEW_OPTION_SHOW_DETAILS\|VIEW_OPTION_PIN\|small-buttons" src/angular/src/app/
   ```
   Expected: No matches in any .ts, .html, or .scss files.

4. **Visual verification (optional):**
   Start the dev server and verify the file options bar shows only:
   - Search input
   - Status filter dropdown
   - Sort dropdown
   - No Details button, no Pin button
</verification>

<success_criteria>
- [ ] Details button (`#toggle-details`) removed from file-options template
- [ ] Pin button (`#pin-filter`) and container (`#small-buttons`) removed from template
- [ ] `showDetails` property removed from ViewFileOptions interface, defaults, and class
- [ ] `pinFilter` property removed from ViewFileOptions interface, defaults, and class
- [ ] `setShowDetails()` method removed from ViewFileOptionsService
- [ ] `setPinFilter()` method removed from ViewFileOptionsService
- [ ] `VIEW_OPTION_SHOW_DETAILS` constant removed from StorageKeys
- [ ] `VIEW_OPTION_PIN` constant removed from StorageKeys
- [ ] `.sticky` class and `#toggle-details`, `#small-buttons`, `#pin-filter` styles removed from SCSS
- [ ] `.details` section removed from file.component.html and file.component.scss
- [ ] All showDetails and pinFilter tests removed from spec file
- [ ] `ng build` completes without errors
- [ ] `ng test` passes all remaining tests
- [ ] No grep matches for removed identifiers
</success_criteria>

<output>
After completion, create `.planning/phases/09-remove-obsolete-buttons/09-01-SUMMARY.md`
</output>
