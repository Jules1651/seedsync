# Detailed V1.0 Code Changes Reference

## File-by-File Breakdown

### 1. src/angular/angular.json
**Type**: Configuration (JSON)
**Changes**: -2 lines | +0 lines = -2 net

**What Changed**:
- Removed `"node_modules/bootstrap/dist/css/bootstrap.min.css"` from build configuration
- Location 1: Build styles array (line 36)
- Location 2: Test styles array (line 91)

**Why**:
Bootstrap CSS no longer needed as source file. It's now imported via SCSS variables and functions in the theme configuration.

---

### 2. src/angular/src/app/common/_bootstrap-variables.scss
**Type**: SCSS Variables (NEW CONTENT)
**Changes**: +37 lines | -0 lines = +37 net

**New Variables Defined**:
```scss
// Bootstrap theme colors (override defaults)
$primary: #337BB7              // App primary blue
$secondary: #79DFB6            // App teal
$success: #198754              // Semantic "add" actions
$danger: #dc3545               // Semantic "remove" actions
$warning: #ffc107              // Bootstrap default yellow
$info: #0dcaf0                 // Bootstrap default cyan

// Application-specific derived colors
$primary-color: $primary
$primary-dark-color: #2e6da4
$primary-light-color: #D7E7F4
$primary-lighter-color: #F6F6F6

$secondary-color: $secondary
$secondary-light-color: #C5F0DE
$secondary-dark-color: #32AD7B
$secondary-darker-color: #077F4F

$header-color: #DDDDDD
$header-dark-color: #D3D3D3

$logo-color: #118247
$logo-font: 'Arial Black', Gadget, sans-serif
```

**Purpose**: Central location for Bootstrap theme customization

---

### 3. src/angular/src/app/common/_common.scss
**Type**: SCSS Variables & Mixins
**Changes**: +33 lines | -42 lines = -9 net

**Removed**:
- Custom `%button` placeholder with all styling rules (35 lines)
  - background-color, border, cursor, user-select
  - :active, [disabled], .selected pseudo-class styles

**Added**:
- Import `_bootstrap-variables.scss` file
- Re-exported Bootstrap semantic color variables
  - `$warning-text-emphasis` (shade-color($warning, 60%))
  - `$danger-text-emphasis` (shade-color($danger, 60%))
  - `$warning-bg-subtle` (tint-color($warning, 80%))
  - `$danger-bg-subtle` (tint-color($danger, 80%))
  - `$warning-border-subtle` (tint-color($warning, 60%))
  - `$danger-border-subtle` (tint-color($danger, 60%))
- Gray scale variables
  - `$gray-100: #f8f9fa`
  - `$gray-300: #dee2e6`
  - `$gray-800: #343a40`

**Preserved**:
- Layout variables ($small-max-width, $medium-*, $large-*, $sidebar-width)
- Z-index variables ($zindex-sidebar, $zindex-top-header, etc.)

---

### 4. src/angular/src/app/pages/autoqueue/autoqueue-page.component.html
**Type**: HTML Template
**Changes**: +16 lines | -9 lines = +7 net

**Removed Pattern**:
```html
<div class="button" appClickStopPropagation
     [attr.disabled]="...">
    <span>icon</span>
</div>
```

**New Pattern**:
```html
<button class="btn btn-danger" type="button"
        [disabled]="..."
        (click)="handler()">
    <span>icon</span>
</button>
```

**Specific Changes**:
- Remove pattern button: btn-danger (red)
- Add pattern button: btn-success (green)
- Changed from [attr.disabled] to native [disabled]
- Added type="button" for semantic HTML

---

### 5. src/angular/src/app/pages/autoqueue/autoqueue-page.component.scss
**Type**: SCSS Styles
**Changes**: +6 lines | -39 lines = -33 net

**Removed**:
- Custom red button styles (.pattern .button)
  - background-color: red
  - border-color: darkred
  - :active and [disabled] states
- Custom green button styles (#add-pattern .button)
  - background-color: green
  - border-color: darkgreen
  - :active and [disabled] states

**Updated Button Styling**:
```scss
.btn {
    flex-grow: 0;
    display: flex;
    flex-direction: row;
    align-items: center;
    justify-content: center;
    padding: 8px;
    margin-right: 12px;
    height: 40px;      // Was 35px
    width: 40px;       // Was 35px
    
    span { font-size: 220%; }
}
```

---

### 6. src/angular/src/app/pages/files/bulk-actions-bar.component.html
**Type**: HTML Template
**Changes**: +10 lines | -10 lines = no net change

**Button Migrations**:
```
Queue:          btn btn-primary (unchanged)
Stop:           btn-warning → btn-danger (RED)
Extract:        btn-info → btn-secondary (GRAY)
Delete Local:   btn-outline-danger → btn-danger (RED)
Delete Remote:  btn-danger → btn-danger (unchanged)
```

**Removed**: btn-sm (small) class from all buttons

**Impact**: Consistent button sizing across page

---

### 7. src/angular/src/app/pages/files/file-actions-bar.component.html
**Type**: HTML Template
**Changes**: +10 lines | -10 lines = no net change

**Same Changes as bulk-actions-bar**:
- Queue: btn-primary
- Stop: btn-warning → btn-danger
- Extract: btn-info → btn-secondary
- Delete Local: btn-outline-danger → btn-danger
- Delete Remote: btn-danger
- Removed btn-sm

---

### 8. src/angular/src/app/pages/files/file-list.component.scss
**Type**: SCSS Styles
**Changes**: +4 lines | -4 lines = no net change

**Color Updates**:
```scss
// Before: rgba(255, 255, 255, 0.8)
// After:  rgba(white, 0.8)

// Before: #333
// After:  $gray-800

// Before: #fff
// After:  white

// Before: #000
// After:  black
```

**Result**: More semantic color usage

---

### 9. src/angular/src/app/pages/files/file.component.html
**Type**: HTML Template
**Changes**: +62 lines | -35 lines = +27 net

**Complete Button Migration** (5 action buttons):
```html
<!-- BEFORE: Custom div-based buttons -->
<div class="button" appClickStopPropagation
     [attr.disabled]="isQueueable() ? null : true"
     (click)="!isQueueable() || onQueue(file)"
     [class.loading]="activeAction == FileAction.QUEUE">
    <div class="loader"></div>
    <img src="assets/icons/queue.svg" />
    <div class="text"><span>Queue</span></div>
</div>

<!-- AFTER: Bootstrap button with spinner -->
<button class="btn btn-primary action-button" appClickStopPropagation
        [disabled]="!isQueueable()"
        (click)="onQueue(file)"
        [class.loading]="activeAction === FileAction.QUEUE">
    <span *ngIf="activeAction === FileAction.QUEUE"
          class="spinner-border spinner-border-sm"
          aria-hidden="true"></span>
    <img *ngIf="activeAction !== FileAction.QUEUE"
         src="assets/icons/queue.svg" alt="" />
    <span class="text">Queue</span>
</button>
```

**5 Buttons Updated**:
1. Queue: btn-primary
2. Stop: btn-danger
3. Extract: btn-secondary
4. Delete Local: btn-danger
5. Delete Remote: btn-danger

**Key Improvements**:
- Bootstrap spinner replaces custom animation
- Conditional rendering (*ngIf) for icon vs spinner
- Better accessibility (aria-hidden)

---

### 10. src/angular/src/app/pages/files/file.component.scss
**Type**: SCSS Styles
**Changes**: +63 lines | -136 lines = -73 net

**Removed Custom Elements** (92 lines deleted):
- %button placeholder extension in .actions .button
- Custom button margins and dimensions
- Custom .text layout styling
- Custom .loader CSS animation (keyframes spin)
- Custom loading state styling with secondary-dark-color
- Custom icon inversion filter

**New Action Button Styling**:
```scss
.actions .action-button {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    width: 60px;
    min-width: 60px;
    height: 60px;
    margin-bottom: 10px;
    margin-right: 10px;
    padding: 4px;
    
    img {
        width: 25px;
        height: 25px;
        filter: invert(1);  // Changed from 1.0
    }
    
    .text {
        font-size: 12px;
        text-align: center;
        line-height: 12px;
        margin-top: 4px;
    }
    
    &:disabled img {
        opacity: 0.5;
    }
    
    &.loading {
        pointer-events: none;  // Bootstrap spinner shown via img
    }
}
```

**Enhancement**: File row hover transition
```scss
.file:not(.selected):not(.bulk-selected):hover {
    background-color: $secondary-light-color;
    transition: background-color 0.1s ease;  // NEW
}
```

---

### 11. src/angular/src/app/pages/files/selection-banner.component.scss
**Type**: SCSS Styles
**Changes**: +3 lines | -7 lines = -4 net

**Color Scheme Change** (Primary → Secondary):
```scss
// Before
background-color: $primary-light-color
border: 1px solid $primary-color
color: $primary-dark-color

// After
background-color: $secondary-color
border: 1px solid $secondary-dark-color
color: $secondary-darker-color
```

**Impact**: More prominent teal banner for selection feedback

---

### 12. src/angular/src/app/pages/logs/logs-page.component.scss
**Type**: SCSS Styles
**Changes**: +12 lines | -11 lines = +1 net

**Button Cleanup**:
- Removed `@extend %button` from `.btn-scroll`
- Changed `display: inherit` to `display: block`

**Alert Color Migrations**:
```scss
// Warning alerts (BEFORE hardcoded)
// Before: color: #8a6d3b; background-color: #fcf8e3; border-color: #faebcc;
// After:  Variables as follows
color: $warning-text-emphasis
background-color: $warning-bg-subtle
border-color: $warning-border-subtle

// Error/Critical alerts (BEFORE hardcoded)
// Before: color: #a94442; background-color: #f2dede; border-color: #ebccd1;
// After:  Variables as follows
color: $danger-text-emphasis
background-color: $danger-bg-subtle
border-color: $danger-border-subtle

// Borders
border-bottom: 1px solid $gray-300  // Was #e3e3e3
background-color: $gray-100         // Was #f5f5f5
```

---

### 13. src/angular/src/app/pages/settings/option.component.scss
**Type**: SCSS Styles
**Changes**: +3 lines | -3 lines = no net change

**Error State Color Update**:
```scss
// Before
background-color: #f2dede
color: #a94442
border: 1px solid #a94442

// After
background-color: $danger-bg-subtle
color: $danger-text-emphasis
border: 1px solid $danger-border-subtle
```

---

### 14. src/angular/src/app/pages/settings/settings-page.component.html
**Type**: HTML Template
**Changes**: +9 lines | -0 lines = +9 net

**Restart Button Migration**:
```html
<!-- BEFORE -->
<div class="button" appClickStopPropagation [attr.disabled]="commandsEnabled ? null : true"
     (click)="!commandsEnabled || onCommandRestart()">
    <img src="assets/icons/refresh.svg" />
    <span class="text">Restart</span>
</div>

<!-- AFTER -->
<button class="btn btn-primary" type="button"
        [disabled]="!commandsEnabled"
        (click)="onCommandRestart()">
    <img src="assets/icons/refresh.svg" alt="" />
    <span class="text">Restart</span>
</button>
```

---

### 15. src/angular/src/app/pages/settings/settings-page.component.scss
**Type**: SCSS Styles
**Changes**: +8 lines | -0 lines = +8 net

**Button Styling Updates**:
```scss
.btn {
    display: flex;
    flex-direction: row;
    align-items: center;  // NEW
    padding: 10px;
    margin-right: 8px;
    height: 40px;
    
    img {
        width: 20px;
        height: 20px;
        filter: invert(1);   // Changed from 1.0
    }
}
```

---

### 16. src/docker/test/angular/Dockerfile
**Type**: Docker Configuration
**Changes**: +18 lines | -0 lines = +18 net

**ARM64 Support Added**:
```dockerfile
# Before: Only AMD64 support
RUN apt-get update && \
    apt-get install -y wget gnupg && \
    wget -nv -O /tmp/chrome.deb https://dl.google.com/linux/direct/google-chrome-stable_current_amd64.deb && \
    dpkg -i /tmp/chrome.deb || apt-get -fy install

# After: Conditional ARM64/AMD64
RUN apt-get update && \
    ARCH=$(dpkg --print-architecture) && \
    if [ "$ARCH" = "arm64" ]; then \
        apt-get install -y chromium chromium-driver && \
        ln -s /usr/bin/chromium /usr/bin/google-chrome; \
    else \
        apt-get install -y wget gnupg && \
        wget -nv -O /tmp/chrome.deb https://dl.google.com/linux/direct/google-chrome-stable_current_amd64.deb && \
        dpkg -i /tmp/chrome.deb || apt-get -fy install; \
    fi
```

**Logic**:
- Detect architecture using `dpkg --print-architecture`
- ARM64: Install Chromium (Chrome not available for ARM64 Linux)
- AMD64: Install Google Chrome from official repo
- Create symlink for compatibility

---

## Change Patterns Summary

### Pattern 1: Custom Div → Bootstrap Button
**Applied to**: 6 locations across 5 components
```html
<div class="button" appClickStopPropagation [attr.disabled]="condition ? null : true">
↓
<button class="btn btn-{color}" [disabled]="!condition">
```

### Pattern 2: Custom Colors → Bootstrap Variables
**Applied to**: 5 SCSS files
```scss
#333 → $gray-800
#f2dede → $danger-bg-subtle
#8a6d3b → $warning-text-emphasis
```

### Pattern 3: Custom Spinner → Bootstrap Spinner
**Applied to**: file.component
```html
<div class="loader"></div>
↓
<span class="spinner-border spinner-border-sm" aria-hidden="true"></span>
```

### Pattern 4: Architecture-Conditional Logic
**Applied to**: Dockerfile
```dockerfile
if [ "$ARCH" = "arm64" ]; then ... else ... fi
```

